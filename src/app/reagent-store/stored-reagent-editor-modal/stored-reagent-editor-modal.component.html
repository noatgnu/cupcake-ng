<div class="modal-header">
  <h5 class="modal-title">
    Entry Editor
  </h5>
</div>
<div class="modal-body">
  @if (storedReagent) {
    <b>Entry Basic Data</b>
    <form [formGroup]="form" class="d-flex flex-column gap-2">
      <div class="form-floating">
        <input type="number" class="form-control" id="quantity" formControlName="quantity" placeholder="Entry Quantity ({{storedReagent.reagent.unit}})">
        <label for="quantity">Entry Quantity ({{storedReagent.reagent.unit}})</label>
      </div>
      <div class="form-floating">
        <textarea class="form-control" id="notes" formControlName="notes" placeholder="Entry Notes"></textarea>
        <label for="notes">Entry Notes</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="shareable" formControlName="shareable">
        <label class="form-check-label" for="shareable">
          Shareable
        </label>
      </div>
      <div class="form-floating">
        <input type="text" class="form-control" id="barcode" formControlName="barcode" placeholder="Barcode">
        <label for="barcode">Barcode</label>
      </div>
      <div class="d-flex flex-row justify-content-center">
        <svg id="stored-reagent-{{storedReagent.id}}-barcode-canvas" width="300" height="300"></svg>
      </div>
    </form>
    <hr>
    <b>Item Metadata</b>
    @if (storedReagent.metadata_columns.length > 0) {
      <div class="d-flex gap-2 flex-wrap">
        @for (m of storedReagent.metadata_columns; track m.id) {
          <span class="badge bg-primary">{{m.name}}: {{m.value}} <i class="bi bi-x-circle" ngbTooltip="Remove" (click)="removeMetadata(m)"></i></span>
        }
      </div>
    }


    <form [formGroup]="formMetadata" class="d-flex flex-column gap-2">

      <div class="form-group">
        <label for="metadataName">Metadata Name</label>
        <input type="text" id="metadataName" formControlName="name" [ngbTypeahead]="searchName" class="form-control">
      </div>
      <div class="form-group">
        <label for="metadataValue">Metadata Value</label>
        <input type="text" id="metadataValue" formControlName="value" [ngbTypeahead]="searchValue" class="form-control">
      </div>
      <div>
        <button ngbTooltip="Adding metadata" type="submit" class="btn btn-primary" (click)="addMetadataColumn()">+</button>
      </div>

    </form>
  }
</div>
<div class="modal-footer">
  <button type="button" class="btn btn-primary" (click)="submit()">Submit</button>
  <button type="button" class="btn btn-secondary" (click)="close()">Close</button>
</div>
